<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
</head>
<style>
    body {
        background-image: url("https://ssb.wiki.gallery/images/thumb/7/73/SSBU-Pok%C3%A9mon_Stadium_2.png/1200px-SSBU-Pok%C3%A9mon_Stadium_2.png");
        background-size: cover;
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
</style>
<body>
    <div class="container text-center">
        <button onclick="test()" type="button" class="btn btn-danger btn-lg">Begin Battle!</button>
    </div>
    {% block content %}
    <div class="container">
        <div class="container text-end my-5">
            <div class="row g-3">
                <h1 style="color: white;">Enemy Team</h1>

                {% for pokemon in enemy_pokemon %}
                  <div class="col-md-2">
                        <img src="{{pokemon['f_shiny']}}" class="team-2 active img-thumbnail rounded-circle border border-4" alt="pokemon" style="background-color: #{{colors[pokemon['type']]}};">
                        <div class="card-body">
                        </div>
                  </div>
                {% endfor %}
            </div>
        </div>
        <div class="container text-end my-5">
            <div class="row g-3">
                <h1 style="color: white;">User Team</h1>
                {% for pokemon in owned %}
                  <div class="col-md-2">
                        <img src="{{pokemon['f_shiny']}}" class="team-1 active img-thumbnail rounded-circle border border-4" alt="pokemon" style="background-color: #{{colors[pokemon['type']]}};">
                        <div class="card-body">
                        </div>
                  </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endblock %}
<script>

let divs = document.getElementsByClassName("img-thumbnail");
let team1 = document.getElementsByClassName("team-1");
let team2 = document.getElementsByClassName("team-2");
let teams = [team1, team2]

function checkWinner (team1, team2){
  if (team1.length == 0) {
    console.log("Enemy won!")
  } else if (team2.length == 0) {
    console.log("User won!")
  }
};

function getRandomInt(max) {
  return Math.floor(Math.random() * max);
}

function getRandomTeam(arr) {

// get random index value
const randomIndex = Math.floor(Math.random() * arr.length);

// get random item
const item = arr[randomIndex];

return item;
}

function delay (ms) {
    return new Promise((resolve,reject) => setTimeout(resolve,ms));
};

async function test () {

  while (team1.length > 0 && team2.length > 0) {

    await delay(200);
    team = getRandomTeam(teams);
    let num = getRandomInt(team.length);
    team[num].classList.add("opacity-25");
    team[num].classList.remove("active");
    team1 = document.getElementsByClassName("team-1 active");
    team2 = document.getElementsByClassName("team-2 active");
    checkWinner(team1, team2)

  };


};
</script>
</body>
</html>